<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jagdamb99 - Sales & Profit Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Jagdamb99 - Sales & Profit Analysis</h1>

    <label for="start-date">Start Date:</label>
    <input type="date" id="start-date">
    
    <label for="end-date">End Date:</label>
    <input type="date" id="end-date">
    
    <button onclick="fetchData()">Show Analysis</button>

    <canvas id="salesChart"></canvas>

    <script>
        function fetchData() {
            let startDate = document.getElementById("start-date").value;
            let endDate = document.getElementById("end-date").value;

            fetch("/get_sales_data", {
                method: "POST",
                body: JSON.stringify({ start_date: startDate, end_date: endDate }),
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                let dates = data.map(d => d.Date);
                let sales = data.map(d => d["Total Sales (₹)"]);
                let profits = data.map(d => d["Total Profit (₹)"]);

                new Chart(document.getElementById("salesChart"), {
                    type: "line",
                    data: {
                        labels: dates,
                        datasets: [
                            { label: "Total Sales (₹)", data: sales, borderColor: "blue" },
                            { label: "Total Profit (₹)", data: profits, borderColor: "green" }
                        ]
                    }
                });
            });
        }
    </script>
</body>
</html>
